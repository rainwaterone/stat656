\pdfminorversion=7
\documentclass[12pt]{article}

\usepackage{cmu-techreport}
\usepackage{listings}
\usepackage{minted}
\usemintedstyle{borland}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{lscape}
\usepackage{rotating}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

%\lstset{frame=tb,
%  language=Python,
%  aboveskip=3mm,
%  belowskip=3mm,
%  showstringspaces=false,
%  columns=flexible,
%  basicstyle={\small\ttfamily},
%  numbers=none,
%  numberstyle=\tiny,
%  keywordstyle=,
%  commentstyle=\color{dkgreen},
%  stringstyle=\color{mauve},
%  breaklines=true,
%  breakatwhitespace=true,
%  tabsize=3
%}

\lstset{language=SAS,
  frame=single,
  backgroundcolor=\color{yellow!20},
  breaklines=true,
  numbers=left,
  stepnumber=1,
 numberstyle=\footnotesize,
  basicstyle=\ttfamily\bfseries,
  columns=fixed,
  keepspaces=true,
  identifierstyle=\color{blue}\ttfamily,
  keywordstyle=\color{cyan}\ttfamily,
  stringstyle=\color{purple}\ttfamily,
  commentstyle=\color{green}\ttfamily,
  } 


\title{STAT 608 Homework \#8}
\author{E. Lee Rainwater}
\date{16 July 2020}
\abstract{Clustering algorithms were implemented via SAS Enterprise Miner\textsuperscript{\textregistered} and manual iteration to classify reviews of California Cabernet Sauvignon wines.}

%\keywords{technical reports, typesetting, Carnegie Mellon University}

%\trnumber{CMU-CS-90-999}

%\citationinfo{\begin{center}
%To appear in a \TeX\ collection near you.
%\end{center}}

%\arpasupport{fox}
% \othersupport{the National Science Foundation under grant number 99-999-99}
% \authorsupport{The author holds a Froboz Gradual Fellowship.}

% \otherdisclaimer{NSF}



\makeatother

\usepackage{listings}
\renewcommand{\lstlistingname}{Listing}

\begin{document}
\maketitle

\section{Introduction}
In this exercise, SAS Enterprise Miner\textsuperscript{\textregistered} was utilized to conduct a clustering study on Californian cabernet sauvignon wines. The goal is the delivery of a list of exactly 9 clusters of word and word pairs, based upon a collection of wine reviews; with each cluster containing 15 words or word-pairs. A tabulation was then generated by SAS which displayed aggregated means for the cost and review points for the wines in each cluster.


The following general steps were used to evaluate various regression
methods and feature selection methods: 
\begin{enumerate}
\item Import the review data contained in  \texttt{CaliforniaChardonnay.xlsx} into SAS
\item Parse the text from the \textit{description} field using the \textbf{Text Parsing} node. \textit{Parts-of-speech}, noun groups, and stemming were enabled in the \textit{Property} pane of this node as shown in Figure~\ref{fig:textPars}.
\item Use the \textbf{Text Filter} node to filter out terms appearing in fewer than four documents. Term weighting was applied via the \textit{Inverse Document Frequency} method.
\item Implement the \textit{Expectation-Maximization} clustering algorithm to extract terms into 9 clusters of 15 terms each. This algorithm attempts to form a fixed number of $k$ clusters in which the difference in the means across clusters, aggregated over the variables within each cluster, is maximized.
\item Iteratively explore the resulting clusters for duplicative terms, as well as other terms which do not contribute significant information to the clusters. Remove them, either by adding them to the list of \textit{stopped} words or by unchecking the associated \textit{keep} box in the Interactive Filter Viewer (located in the properties pane of the \textbf{Text Filter} node. Likewise, attempt to merge terms that are synonymic.
\item Once an acceptable set of clusters is obtained, utilize the \textbf{SAS Code} node to execute a script showing the average points and average price for the wines whose reviews were represented in each cluster.
\end{enumerate}

\section{General Observations}
The initial clusters contained a number of "low-information" terms which did not contribute significantly to the information in the cluster. Examples of such terms are:
\begin{enumerate}
\item Terms which were so closely-related as to be synonyms in the context of the reviews, such as \textit{cedar} and \textit{cedar flavor}. Such terms were only eliminated when they appeared within the same cluster, indicating that they were contextually similar.
\item Terms which were contextually common to all clusters, \textit{e.g.}, \textit{cab(s)}, \textit{cabernet, given that} all \textit{reviews considered were for cabernet wines}, \textit{bottle, glass, barrel}, and such other terms which did not practically distinguish one cluster form another. 
\end{enumerate}
The steps of generating the clusters and removing "low-information" terms required over ten iterations to produce the finalized clusters.

\section{Final Clusters and Characteristics}
The final clusters, along with arbitrarily-generated cluster names, are presented in Table~\ref{tab:clusterTable}. The primary means of influencing the subjective quality of the clusters was the elimination of synonymic terms and those of less relevance. The remaining terms tended to be highly-descriptive noun groups and adjectives which evoked strong imagery of gustatory and olfactory sensations (although some visual imagery may be triggered as well). A graph of the relative distribution of the clusters is presented as Figure~\ref{fig:textPie}. The relative Pythagorean distance between clusters is shown in Figure~\ref{fig:textDist}.

\begin{table}[H]
	\begin{center}
	\label{tab:clusterTable}
	\caption{Final Clusters and Metrics}
	\includegraphics[width=7.25in, keepaspectratio, angle=270]{clusters-crop.pdf}
	\end{center}
\end{table}

\begin{figure}
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-clusterPie.png}
	\caption{Distribution of Text Clusters}
	\label{fig:textPie}
\end{figure}
\begin{figure}[H]
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-clusterDist.png}
	\caption{Pythagorean Distance of Clusters}
	\label{fig:textDist}
\end{figure}


\section{Appendix}




\subsection{Code Listing}
Below is the SAS code used to generate the tabulation of wine points and cost.

{\tiny{}}
\begin{lstlisting}
ODS RTF FILE="C:\Users\rainwater-e\...\hw-08\CABERNET.RTF";
PROC TABULATE DATA=&EM_IMPORT_DATA;
CLASS TextCluster_cluster_;
VAR POINTS PRICE;
TABLE textCluster_cluster_, (POINTS PRICE)*MEAN;

RUN;
ODS RTF CLOSE;
\end{lstlisting}
\pagebreak


\subsection{SAS Enterprise Miner Property Panes}
\nopagebreak[4]
\begin{figure}[H]
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-FileImport.png}
	\caption{File Import Node Properties}
	\label{fig:fileImp}
\end{figure}


\begin{figure}
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-textParsing.png}
	\caption{Text Parsing Node Properties}
	\label{fig:textPars}
\end{figure}

\begin{figure}
	\label{fig:textFilt}
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-textFilter.png}
	\caption{Text Filter Node Properties}
\end{figure}

\begin{figure}
	\label{fig:textClus}
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-TextCluster.png}
	\caption{Text Cluster Node Properties}
\end{figure}

\begin{figure}
	\label{fig:sasCode}
	\includegraphics[width=\textwidth, height=\textheight, keepaspectratio]{em-SAS-code.png}
	\caption{SAS Code Node Properties}
\end{figure}

%{\tiny\par}
%
%{\tiny{}The title, authors, date, and technical report number will
%be typeset so as to be centered within the cut-out on the technical
%report cover page. If the material will not fit, you will get either
%an \verb+overfull \hbox+ message (if the material is too wide) or
%an \verb+overfull \vbox+ message (if the material is too long.) To
%create the title page, simply use \verb+\maketitle+ after \verb+\begin{document}+.}{\tiny\par}
%
%{\tiny{}In the interest of legibility technical reports should not
%be typeset at sizes below eleven point.}{\tiny\par}
\end{document}
